`val maxId = rep(Double.NegativeInfinity)(math.max(_, nbr(_).maxId)) { x => x == nbr(x).maxId }`